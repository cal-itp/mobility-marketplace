---
# Build a data file of site content to feed into the search index
layout: data
---
{% assign documents = site.documents | where: "index", true %}

[
{% for doc in documents %}
  {
    "id": "{{ forloop.index0 }}",
    "url": "{{ doc.url | absolute_url }}",
    "title": "{{ doc.title }}",
    "body": "{{ doc.content | markdownify
        | replace: '</h1>', ': ' | replace: '</h2>', ': ' | replace: '</h3>', ': '
        | replace: '</h4>', ': ' | replace: '</h5>', ': ' | replace: '</h6>', ': '
        | newline_to_br | replace: '<br />', ' ' | strip_html
        | replace: '.', '. ' | replace: '!', '! ' | replace: '?', '? '
        | replace: '  ', ' ' | strip }}"
  }{% unless forloop.last %},{% endunless %}
{% endfor %}
]